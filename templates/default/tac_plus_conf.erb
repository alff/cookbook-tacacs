# Generated by Chef.
# Local modifications will be overwritten.

accounting file = <%= node['tacacs']['acct_log_path'] %>

<% if node['tacacs']['tac_key'] -%>
key = <%= node['tacacs']['tac_key'] %>
<% end -%>

default authentication = file /etc/passwd

<% ! @admins.empty? && @admins.each do |admin| -%>
user = <%= admin %> {
    member = admin
}
<% end -%>

<% ! @viewers.empty? && @viewers.each do |viewer| -%>
user = <%= viewer %> {
    member = viewonly
}
<% end -%>

group = admin {
    default service = permit
}

group = viewonly {
    default service = deny
    cmd = show {
        permit .*
    }
    cmd = enable {
        permit .*
    }
}
