# Generated by Chef.
# Local modifications will be overwritten.

accounting file = <%= @acc_log_path %>

<% if @tac_key %>
key = <%= @tac_key %>
<% end %>

default authentication = file /etc/passwd

<% ! @admins.empty? && @admins.each do |admin| %>
user = <%= admin %> {
    member = admin
}
<% end %>

<% ! @viewers.empty? && @viewers.each do |viewer| %>
user = <%= viewer %> {
    member = viewonly
}
<% end %>

group = admin {
    default service = permit
}

group = viewonly {
    default service = deny
    cmd = show {
        permit .*
    }
    cmd = enable {
        permit .*
    }
}
